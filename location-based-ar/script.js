window.onload = () => {
    let places = staticLoadPlaces();
    renderPlaces(places);
};

    function staticLoadPlaces() {
    const arr1 =   [
          103.7026,1.33621,
          103.70265,1.33621,
          103.70291,1.33622,
          103.70331,1.33622,
          103.70338,1.33622,
          103.70346,1.33623,
          103.7035,1.33624,
          103.70351,1.33605,
          103.70352,1.33587,
          103.70351,1.33567,
          103.70351,1.33562,
          103.70348,1.33551,
          103.70347,1.3355,
          103.70346,1.33546,
          103.70345,1.33523,
          103.70345,1.33519,
          103.70346,1.33518,
          103.70346,1.33514,
          103.70347,1.33513,
          103.70348,1.33512,
          103.70349,1.33511,
          103.7035,1.3351,
          103.70352,1.33509,
          103.70354,1.33508,
          103.70356,1.33508,
          103.70361,1.33507,
          103.70379,1.33506,
          103.70411,1.33506,
          103.70473,1.33508,
          103.70503,1.33518,
          103.70518,1.33525,
          103.7054,1.33543,
          103.70558,1.33563,
          103.70572,1.33586,
          103.70573,1.33587,
          103.70581,1.336,
          103.70582,1.33603,
          103.70582,1.33606,
          103.70582,1.3361,
          103.70579,1.33613,
          103.70576,1.33615,
          103.70554,1.33623,
          103.70542,1.3363,
          103.70523,1.3364,
          103.70526,1.33646,
          103.70567,1.33629
          103.70579,1.33625,
          103.70582,1.33624,
          103.70583,1.33624,
          103.70584,1.33624,
          103.70584,1.33625,
          103.70585,1.33625
          103.70585,1.33626,
          103.70586,1.33628,
          103.70587,1.3363,
          103.70588,1.33633,
          103.7059,1.33634,
          103.70597,1.33636,
          103.70596,1.3364,
          103.70598,1.33646,
          103.706,1.33642,
          103.70601,1.33637,
          103.70605,1.33639,
          103.70607,1.3364,
          103.70617,1.33637,
          103.7062,1.33635,
          103.70632,1.33625,
          103.70632,1.33623,
          103.70632,1.33622,
          103.70633,1.33622,
          103.70635,1.33621,
          103.70642,1.33619,
          103.70645,1.33619,
          103.70649,1.33619,
          103.70679,1.33619,
          103.70726,1.33619,
          103.70727,1.33621,
          103.70728,1.33621,
          103.70729,1.33621,
          103.7073,1.33621, 
          103.70731,1.33621,
          103.70734,1.33621,
          103.70734,1.33619,
          103.70734,1.33609,
          103.70734,1.33602,
          103.70738,1.33602,
          103.70741,1.33602,
          103.70747,1.33601,
          103.70751,1.33599,
          103.70755,1.33595,
          103.70759,1.33592,
          103.70763,1.33585,
          103.70765,1.33578,
          103.70766,1.33573,
          103.70767,1.33569,
          103.70767,1.33566,
          103.70767,1.33564,
          103.70766,1.3356,
          103.70764,1.33555,
          103.70756,1.33533,
          103.70753,1.33525,
          103.7075,1.33518,
          103.70745,1.3351,
          103.70742,1.33505,
          103.70738,1.33499,
          103.70733,1.33492,
          103.70724,1.33485,
          103.70711,1.33475,
          103.7071,1.33474,
          103.70709,1.33473,
          103.70709,1.33472,
          103.70715,1.33463,
          103.70716,1.33461,
          103.7072,1.33456,
          103.70729,1.33447,
          103.70745,1.33469,
          103.70751,1.33478,
          103.70754,1.33483,
          103.70767,1.33513,
          103.70776,1.33536,
          103.70784,1.33558,
          103.70788,1.33567,
          103.70806,1.33617,
          103.70823,1.33667,
          103.70836,1.33707,
          103.7084,1.33719,
          103.70843,1.33726,
                      103.72244,1.3414,
          103.72245,1.34138,
          103.72252,1.34133,
          103.72267,1.34123,
          103.72275,1.34117,
          103.72318,1.34102,
          103.72329,1.341,
          103.72342,1.34099,
          103.72364,1.34096,
          103.72364,1.34091,
          103.72364,1.34089,
          103.72363,1.34086,
          103.72362,1.34083,
          103.72361,1.3408,
          103.72369,1.34077,
          103.72378,1.34072,
          103.72388,1.34065,
          103.72396,1.34057,
          103.72405,1.34044,
          103.72412,1.3403,
          103.7242,1.34013,
          103.72427,1.34003,
          103.72432,1.33999,
          103.72437,1.34003,
          103.72439,1.34005,
          103.7244,1.34006,
          103.72439,1.34012,
          103.72438,1.34015,
          103.72438,1.34022,
          103.72439,1.34028,
          103.72439,1.34029,
        
    ];

    const arr2 = [];

    let count = 0;

    var temp = new Array();
    for (let i = 0; i < arr1.length;i++) {
    
        if (count == 0) {
            temp.push(arr1[i]);
            count += 1;
        } else if (count == 1) {
            temp.push(arr1[i]);
            count += 1;
        }
        if (count == 2) {
            arr2.push(temp);
            count = 0;
            temp = [];
        }
    }


    const places = [];

    for (let i = 0; i < arr2.length; i++) {
        places.push({name: i, location: {lat: arr2[i][1], lng: arr2[i][0],}});
    }

    
   return places;
}

function renderPlaces(places) {
   let scene = document.querySelector('a-scene');
    
    let end = document.createElement('a-entity');
    end.setAttribute('id', '-1');
    end.setAttribute('gps-entity-place', `latitude:  1.33621; longitude: 103.70246;`);
    end.setAttribute('gltf-model', './assets/chevrons/scene.gltf');
    end.setAttribute('scale', '2 2 2');
    end.setAttribute('position', '1 2 3');
    end.setAttribute('position', 'absolute');
    
    var pos = end.object3D.position;
    scene.appendChild(end);
   
   places.forEach((place) => {
       let latitude = place.location.lat;
       let longitude = place.location.lng;
       let id = place.name;

       let model = document.createElement('a-entity');
       
       model.setAttribute('id', id.toString());
       model.setAttribute('look-at', pos);
       model.setAttribute('gps-entity-place', `latitude: ${latitude}; longitude: ${longitude};`);
       model.setAttribute('gltf-model', './assets/chevrons/scene.gltf');
       model.setAttribute('scale', '2 2 2');
       model.setAttribute('position', '1 2 3');
       model.setAttribute('position', 'absolute');

       model.addEventListener('loaded', () => {
           window.dispatchEvent(new CustomEvent('gps-entity-place-loaded'))
       });
       
       pos = model.object3D.position;

       scene.appendChild(model);
       console.log("seems to be working");
   });
}
